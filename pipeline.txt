Build a pipeline with big data and upload the Jenkins bash script to the cloud web. Use AWS EKS.

################################################################################
Data Source
   ↓
Ingestion (Kafka / Kinesis / S3)
   ↓
Processing (Spark on Kubernetes)
   ↓
Storage (S3 / Data Lake / Redshift)
   ↓
Orchestration & CI/CD (Jenkins)
   ↓
Runtime Platform (AWS EKS)

#################################################
Jenkins:
	•	Builds Docker images
	•	Pushes them to Amazon ECR
	•	Deploys Spark / data jobs to EKS using kubectl or Helm
	•	Uses Bash scripts committed to Git and executed in Jenkins
#################################################
1. Prepare AWS Prerequisites
1.1 AWS Account & IAM
Create or verify:
	•	IAM user/role with:
	◦	EKS
	◦	ECR
	◦	S3
	◦	EC2
	◦	IAMPassRole
Recommended:
	•	Use IAM Roles for Service Accounts (IRSA) for EKS workloads.

1.2 Install Local Tooling
On your admin machine (or Jenkins agent):
aws --version
kubectl version --client
eksctl version
docker --version
helm version

2. Create the EKS Cluster (Big Data Ready)
2.1 Create Cluster

eksctl create cluster \
  --name bigdata-eks \
  --region us-east-1 \
  --nodegroup-name workers \
  --node-type m5.2xlarge \
  --nodes 3 \
  --managed


2026-01-28 20:32:36 [ℹ]  creating addon: metrics-server
2026-01-28 20:32:37 [ℹ]  successfully created addon: metrics-server
2026-01-28 20:32:37 [ℹ]  kubectl command should work with "/Users/yfrimpong/.kube/config", try 'kubectl get nodes'
2026-01-28 20:32:37 [✔]  EKS cluster "bigdata-eks" in "us-east-1" region is ready


############################################
2.2 Configure kubectl
aws eks update-kubeconfig \
  --region us-east-1 \
  --name bigdata-eks

Validate:
kubectl get nodes

############################################


3. Set Up Big Data Processing on EKS
3.1 Install Spark on Kubernetes (Helm)

helm repo add spark-operator https://kubeflow.github.io/spark-operator
helm repo update


helm install spark-operator spark-operator/spark-operator \
  --namespace spark \
  --create-namespace


############################################
3.2 Define Spark Job (YAML)
 
apiVersion: sparkoperator.k8s.io/v1beta2
kind: SparkApplication
metadata:
  name: bigdata-job
  namespace: spark
spec:
  type: Python
  pythonVersion: "3"
  mode: cluster
  image: <AWS_ACCOUNT_ID>.dkr.ecr.us-east-1.amazonaws.com/bigdata-job:latest (336107977801)
  mainApplicationFile: local:///app/job.py
  sparkVersion: "3.5.0"
  executor:
    cores: 2
    instances: 3
    memory: 4g
  driver:
    cores: 1
    memory: 2g

############################################ 4. Containerize the Big Data Job

4. Containerize the Big Data Job
4.1 Example Spark Job (job.py)
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName("BigDataJob").getOrCreate()

df = spark.read.csv("s3a://yaw-bdata-raw-bucket/inputs/", header=True)
df.groupBy("country").count().write.mode("overwrite") \
  .parquet("s3a://my-processed-bucket/output/")

spark.stop()


#############################################

FROM apache/spark-py

WORKDIR /app
COPY job.py /app/job.py


docker build -t bigdata-job . (Successful)

############################################ 5. Create Amazon ECR Repository
5. Create Amazon ECR Repository

aws ecr create-repository \
  --repository-name bigdata-job \
  --region us-east-1

######## Authenticate Docker: 
aws ecr get-login-password --region us-east-1 \
| docker login --username AWS \
--password-stdin 336107977801.dkr.ecr.us-east-1.amazonaws.com

############################################# 6. Jenkins Setup (CI/CD Engine)
######### 6.1 Jenkins Deployment Options

helm repo add jenkins https://charts.jenkins.io
helm repo update

helm install jenkins jenkins/jenkins \
  --namespace jenkins \
  --create-namespace


helm repo add jenkins https://charts.jenkins.io
helm repo update

helm install jenkins jenkins/jenkins \
  --namespace jenkins \
  --create-namespace

"jenkins" has been added to your repositories
Hang tight while we grab the latest from your chart repositories...
...Successfully got an update from the "spark-operator" chart repository
...Successfully got an update from the "jenkins" chart repository
...Successfully got an update from the "brigade" chart repository
Update Complete. ⎈Happy Helming!⎈
NAME: jenkins
LAST DEPLOYED: Thu Jan 29 01:10:14 2026
NAMESPACE: jenkins
STATUS: deployed
REVISION: 1
DESCRIPTION: Install complete
NOTES:
1. Get your 'admin' user password by running:
  kubectl exec --namespace jenkins -it svc/jenkins -c jenkins -- /bin/cat /run/secrets/additional/chart-admin-password && echo
2. Get the Jenkins URL to visit by running these commands in the same shell:
  echo http://127.0.0.1:8080
  kubectl --namespace jenkins port-forward svc/jenkins 8080:8080

3. Login with the password from step 1 and the username: admin
4. Configure security realm and authorization strategy
5. Use Jenkins Configuration as Code by specifying configScripts in your values.yaml file, see documentation: http://127.0.0.1:8080/configuration-as-code and examples: https://github.com/jenkinsci/configuration-as-code-plugin/tree/master/demos

For more information on running Jenkins on Kubernetes, visit:
https://cloud.google.com/solutions/jenkins-on-container-engine

For more information about Jenkins Configuration as Code, visit:
https://jenkins.io/projects/jcasc/


NOTE: Consider using a custom image with pre-installed plugins

######### 6.2 Jenkins Credentials
Jenkins installation.
1. docker network create jenkins

In order to execute Docker commands inside Jenkins nodes, download and run the docker:dind Docker image using the following docker run command:

docker run \
  --name jenkins-docker \
  --rm \
  --detach \
  --privileged \
  --network jenkins \
  --network-alias docker \
  --env DOCKER_TLS_CERTDIR=/certs \
  --volume jenkins-docker-certs:/certs/client \
  --volume jenkins-data:/var/jenkins_home \
  --publish 2376:2376 \
  docker:dind \
  --storage-driver overlay2

#######
docker exec jenkins-blueocean cat /var/jenkins_home/secrets/initialAdminPassword

docker exec jenkins-blueocean cat /var/jenkins_home/secrets/initialAdminPassword
499f137da2b74a9c9dbe5c84b311aec2

#############################
git init
git remote add origin https://github.com/yfrimpong1/bigdatapipeline.git

git add deploy.sh
git commit -m "Add Jenkins deploy script"
git push origin main


https://github.com/yfrimpong1/bigdatapipeline.git
